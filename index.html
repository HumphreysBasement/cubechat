<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset="utf-8">
  <title>WebSockets</title>
</head>
<style>
#log {
  width: 800px;
  height: 800px;
  margin: 0 auto;
  border: solid black;
  border-radius: 7px;
}
#sendmsg {
  width: 230px;
  margin: 30px auto;
}
</style>
<body>

<div id="log"> </div>

<div id="sendmsg">
  <input type = "text" placeholder="message" id="text">
  <button> send </button>
</div>



  <script>

    let name = prompt("What is your name?");
//"ws://localhost:8080"
    let sock = new WebSocket("ws://jimryanishoo.herokuapp.com");

    sock.onopen = () => {
      sock.send(JSON.stringify({
        type: "name",
        data: name
      }));
    }
    let log = document.getElementById('log');

    sock.onmessage = function(event){
      console.log(event);
      let json = JSON.parse(event.data);
      log.innerHTML += json.name + ": " + json.data + "<br>";
    }

    const sendMessage = () => {
      let text = document.getElementById('text').value;
      sock.send(JSON.stringify({
        type: "message",
        data: text
      }));
      log.innerHTML += "you: "+text+"<br>";
      document.getElementById('text').value = "";
    };

    document.querySelector('input').addEventListener("keydown", (event) => {
      if(event.key === 'Enter'){
        sendMessage();
      }
    });


    document.querySelector('button').onclick = () => {
      sendMessage();
    }
  </script>



</body>
</html>
